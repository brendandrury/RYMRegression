var g_keyCodes={esc:27,ret:13,comma:188,backslash:191,slash:220,pageUp:33,pageDown:34,end:35,"home.safari":63273,home:36,backspace:8,up:38,down:40};function updateStyleThemeLabels(){var m=rym.themes.indexOf(window.localStorage.theme);m!=-1?$("#page_frame_theme_switch").html(rym.themes_label[m]):$("#page_frame_theme_switch").html("Auto"),window.localStorage.size_mode?$("#page_frame_size_mode_switch").html("Compact"):$("#page_frame_size_mode_switch").html("Normal")}function updateTheme(){var m="";for(var e in rym.themes)m+=" theme_"+rym.themes[e];if(!window.localStorage.theme){var o="day";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(o="night"),$("html, body").removeClass(m).addClass("theme_"+o)}}function switchSizeMode(m){m.stopPropagation();var e=["smaller"],o=["Compact"],s="";for(var a in e)s+=" size_mode_"+e[a];var t=e.indexOf(window.localStorage.size_mode);if(t++,t>=e.length){$("#page_frame_size_mode_switch").html("Normal"),delete window.localStorage.size_mode,$("html, body").removeClass(s).addClass("size_mode_normal");return}$("#page_frame_size_mode_switch").html(o[t]),window.localStorage.size_mode=e[t],$("html, body").removeClass(s).addClass("size_mode_"+e[t])}function switchTheme(m,e){m.stopPropagation();var o="";for(var s in rym.themes)o+=" theme_"+rym.themes[s];var a;if(e?window.localStorage.theme==e?a=rym.themes.length:a=rym.themes.indexOf(e):(a=rym.themes.indexOf(window.localStorage.theme),a++),a>=rym.themes.length){$("#page_frame_theme_switch").html("Auto"),delete window.localStorage.theme;var t="day";window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(t="night"),$("html, body").removeClass(o).addClass("theme_"+t);return}$("#page_frame_theme_switch").html(rym.themes_label[a]),window.localStorage.theme=rym.themes[a],$("html, body").removeClass(o).addClass("theme_"+rym.themes[a])}rymQ(function(){$(".has_tip").tipTip(),$(".timeago").timeago()});
 
String.prototype.fuzzyTime=function(e){ago=this,e=e||{},this.days=e.days||"d",this.hours=e.hours||"h",this.minutes=e.minutes||"m",this.on=e.on||"",this.ago=ago,this.setMonthArray=e.setMonthArray||["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],this.setMinDays=e.setMinDays||30,this.dateFormat=e.dateFormat||{};var o=new Date,s=new Date(ago),f=o-s;f/=1e3;var M=Math.round(f%60);f=Math.floor(f/60);var d=Math.round(f%60);f=Math.floor(f/60);var p=Math.round(f%24);f=Math.floor(f/24);var v=f;this.formatDate=function(){var _=this.ago,S=this.setMonthArray,m=new Date(_),t=m.getDate(),r=m.getMonth(),n=m.getFullYear();return this.dateFormat=="simple"?_=S[r]+" "+t+"' "+n.toString().slice(2):_=t+" "+S[r]+" "+n};var g;return v!=0?v<this.setMinDays?p!=0?g=v+this.days:g=v+this.days:g=this.on+" "+this.formatDate():p!=0?g=p+this.hours:d==0?g="now":g=d+this.minutes,g},String.prototype.toHHMMSS=function(){var e=parseInt(this,10);if(!e)return"";var o=Math.floor(e/3600),s=Math.floor((e-o*3600)/60),f=e-o*3600-s*60;return s<10&&(s="0"+s),f<10&&(f="0"+f),o+":"+s+":"+f},String.prototype.toMMSS=function(){var e=parseInt(this,10);if(!e)return"";var o=Math.floor(e/60),s=e-o*60;return s<10&&(s="0"+s),o+":"+s},String.prototype.abbreviateNumber=function(){var e=parseInt(this);if(e<1e4)return e;var o=["","k","M","G","T","P","E"],s=Math.log10(e)/3|0;if(s==0)return e;var f=o[s],M=Math.pow(10,s*3),d=e/M;return d.toFixed(1)+f},Math.log10=Math.log10||function(e){return Math.log(e)*Math.LOG10E};var Hogan={};(function(e){e.Template=function(t,r,n,i){t=t||{},this.r=t.code||this.r,this.c=n,this.options=i||{},this.text=r||"",this.partials=t.partials||{},this.subs=t.subs||{},this.ib()},e.Template.prototype={r:function(t,r,n){return""},v:S,t:_,render:function(r,n,i){return this.ri([r],n||RYMtemplate,i)},ri:function(t,r,n){return this.r(t,r,n)},ep:function(t,r){var n=this.partials[t],i=r[n.name];if(n.instance&&n.base==i)return n.instance;if(typeof i=="string"){if(!this.c)throw new Error("No compiler available.");i=this.c.compile(i,this.options)}return i?(this.partials[t].base=i,n.subs&&(this.activeSub===void 0&&(r.stackText=this.text),i=s(i,n.subs,n.partials,r.stackText||this.text)),this.partials[t].instance=i,i):null},rp:function(t,r,n,i){var a=this.ep(t,n);return a?a.ri(r,n,i):""},rs:function(t,r,n){var i=t[t.length-1],a,l,u;if(typeof i=="function"&&(a=i,i=t[t.length-2],l=this.buf.length),!m(i))n(t,r,this);else for(var h=0;h<i.length;h++)t.push(i[h]),n(t,r,this),t.pop();a&&(u=this.buf.substr(l),this.buf=this.buf.substr(0,l),this.b(a(u)))},s:function(t,r,n,i){if(m(t)&&t.length===0)return!1;var a;typeof t=="function"&&(t=this.ms(t,r,n),typeof t=="function"&&(a=t));var l=!!t;return!i&&l&&r&&(a?r.push(a):r.push(typeof t=="object"?t:r[r.length-1])),l},d:function(t,r,n,i){var a,l=t.split("."),u=this.f(l[0],r,n,i),h=this.options.modelGet,b=null;if(t==="."&&m(r[r.length-2]))u=r[r.length-1];else for(var c=1;c<l.length;c++)a=o(l[c],u,h),a!=null?(b=u,u=a):u="";return i&&!u?!1:(!i&&typeof u=="function"&&(r.push(b),u=this.mv(u,r,n),r.pop()),u)},f:function(t,r,n,i){for(var a=!1,l=null,u=!1,h=this.options.modelGet,b=r.length-1;b>=0;b--)if(l=r[b],a=o(t,l,h),a!=null){u=!0;break}return u?(!i&&typeof a=="function"&&(a=this.mv(a,r,n)),a):i?!1:""},b:function(t){this.buf+=t},fl:function(){var t=this.buf;return this.buf="",t},ib:function(){this.buf=""},ms:function(t,r,n){var i=r[r.length-1];return t.call(i)},mv:function(t,r,n){var i=r[r.length-1];return t.call(i)},sub:function(t,r,n,i){var a=this.subs[t];a&&(this.activeSub=t,a(r,n,this,i),this.activeSub=!1)}};function o(t,r,n){var i,a;if(r&&(typeof r=="object"||typeof r=="string"||typeof r=="number")){if(typeof r=="number"&&t==="comma")return r.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");if(typeof r=="number"&&t==="decimal_1")return parseFloat(Math.round(r*100)/100).toFixed(1);if(typeof r=="number"&&t==="decimal_2")return parseFloat(Math.round(r*100)/100).toFixed(2);if(typeof r=="number"&&t==="singular")return r==1;if(typeof r=="number"&&t==="duration_hhmmss")return(r+"").toHHMMSS();if(typeof r=="number"&&t==="duration_mmss")return(r+"").toMMSS();if(t==="uppercase")return r.toUpperCase();if(t==="lowercase")return r.toLowerCase();if(t==="cap_first_word")return r.charAt(0).toUpperCase()+r.slice(1);if(t==="first_item")return r[0];if(t==="last_item")return r[r.length-1];if(t==="all_but_last")return r.slice(0,r.length-1);if(t==="first_2")return r.slice(0,2);if(t==="first_3")return r.slice(0,3);if(t==="first_4")return r.slice(0,4);if(t==="first_5")return r.slice(0,5);if(t==="first_10")return r.slice(0,10);if(t==="rest_1")return r.slice(1);if(t==="rest_2")return r.slice(2);if(t==="rest_3")return r.slice(3);if(t==="rest_4")return r.slice(4);if(t==="rest_5")return r.slice(5);if(t==="rest_10")return r.slice(10);if(t==="is_positive")return r>0;if(t==="has_one_item")return r.length===1;if(t==="has_expand_1")return r.length>1;if(t==="has_expand_2")return r.length>2;if(t==="has_expand_3")return r.length>3;if(t==="has_expand_4")return r.length>4;if(t==="has_expand_5")return r.length>5;if(t==="has_expand_10")return r.length>10;if(t==="abbreviated_num")return(r+"").abbreviateNumber();if(t==="medium_length")return r.length>15&&r.length<=30;if(t==="long_length")return r.length>30&&r.length<=45;if(t==="extralong_length")return r.length>45;if(t==="join_with_comma")return r.join(", ");if(t==="stringify")return JSON.stringify(r,null,2);if(t==="stringify_json_string")return JSON.stringify(JSON.parse(r),null,2);if(t==="escape_for_js")return r.replace(/[\/\(\)\']/g,"\\$&");if(t==="fuzzytime")return r.fuzzyTime();if(t==="img_75")return r.replace(/\{\{size\}\}/g,"75");if(t==="img_150")return r.replace(/[\/\(\)\']/g,"\\$&");if(t==="img_300")return r.replace(/[\/\(\)\']/g,"\\$&");if(t==="img_600")return r.replace(/[\/\(\)\']/g,"\\$&");if(t==="img_900")return r.replace(/[\/\(\)\']/g,"\\$&");r[t]!=null?i=r[t]:n&&r.get&&typeof r.get=="function"&&(i=r.get(t))}return i}function s(t,r,n,i){function a(){}a.prototype=t;function l(){}l.prototype=t.subs;var u,h=new a;h.subs=new l,h.subsText={},h.ib();for(u in r)h.subs[u]=r[u],h.subsText[u]=i;for(u in n)h.partials[u]=n[u];return h}var f=/&/g,M=/</g,d=/>/g,p=/\'/g,v=/\"/g,g=/[&<>\"\']/;function _(t){return String(t==null?"":t)}function S(t){return t=_(t),g.test(t)?t.replace(f,"&amp;").replace(M,"&lt;").replace(d,"&gt;").replace(p,"&#39;").replace(v,"&quot;"):t}var m=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"}})(typeof exports!="undefined"?exports:Hogan);
 
/**
 * Timeago is a jQuery plugin that makes it easy to support automatically
 * updating fuzzy timestamps (e.g. "4 minutes ago" or "about 1 day ago").
 *
 * @name timeago
 * @version 0.11.4
 * @requires jQuery v1.2.3+
 * @author Ryan McGeary
 * @license MIT License - http://www.opensource.org/licenses/mit-license.php
 *
 * For usage and examples, visit:
 * http://timeago.yarp.com/
 *
 * Copyright (c) 2008-2012, Ryan McGeary (ryan -[at]- mcgeary [*dot*] org)
 */(function(n){n.timeago=function(t){return t instanceof Date?v(t):typeof t=="string"?v(n.timeago.parse(t)):typeof t=="number"?v(new Date(t)):v(n.timeago.datetime(t))};var d=n.timeago;n.extend(n.timeago,{settings:{refreshMillis:6e4,allowFuture:!1,strings:{prefixAgo:null,prefixFromNow:"+",suffixAgo:null,suffixFromNow:null,justnow:"now",justnow_long:"just now",seconds:"%d sec",seconds_long:"%d seconds ago",minute:"1m",minute_long:"1 minute ago",minutes:"%dm",minutes_long:"%d minutes ago",hour:"1h",hour_long:"1 hour ago",hours:"%dh",hours_long:"%d hours ago",day:"1d",day_long:"1 day ago",days:"%dd",days_long:"%d days ago",wordSeparator:" ",numbers:[]}},inWords:function(t,e,g,f,l,A){var r=this.settings.strings,j=r.prefixAgo,C=r.suffixAgo;this.settings.allowFuture&&e<0&&(j=r.prefixFromNow,C=r.suffixFromNow);var o=Math.abs(e)/1e3,s=o/60,i=s/60,h=i/24,J=h/365;function a(M,D){var S=n.isFunction(M)?M(D,e):M,b=r.numbers&&r.numbers[D]||D;return S.replace(/%d/i,b)}var _;if(g?_=o<15&&a(r.justnow_long,Math.round(o))||o<45&&a(r.seconds_long,Math.round(o))||o<90&&a(r.minute_long,1)||s<45&&a(r.minutes_long,Math.round(s))||s<90&&a(r.hour_long,1)||i<24&&a(r.hours_long,Math.round(i))||i<42&&a(r.day_long,1)||h<30&&a(r.days_long,Math.round(h)):f?_=o<15&&a(r.justnow,Math.round(o))||o<45&&a(r.seconds,Math.round(o))||o<90&&a(r.minute,1)||s<45&&a(r.minutes,Math.round(s))||s<90&&a(r.hour,1)||i<24&&a(r.hours,Math.round(i))||i<42&&a(r.day,1)||a(r.days,Math.round(h)):_=o<15&&a(r.justnow,Math.round(o))||o<45&&a(r.seconds,Math.round(o))||o<90&&a(r.minute,1)||s<45&&a(r.minutes,Math.round(s))||s<90&&a(r.hour,1)||i<24&&a(r.hours,Math.round(i))||i<42&&a(r.day,1)||h<30&&a(r.days,Math.round(h)),A){var u=new Date(new Date().getTime()-e),c=new Date,w=u.getMonth(),p=u.getDate(),y="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),m=u.getFullYear(),T=c.getFullYear();return p+" "+y[w]+" "+m+", "+t.toLocaleTimeString()}else if(!f&&(l||e>1e3*60*60*24*30)){var u=new Date(new Date().getTime()-e),c=new Date,w=u.getMonth(),p=u.getDate(),y="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),m=u.getFullYear(),T=c.getFullYear();return p+" "+y[w]+" "+(m===T?"":m)}else{if(f&&h>365){var u=new Date(new Date().getTime()-e);return""+u.getFullYear()}var Y=r.wordSeparator===void 0?" ":r.wordSeparator;return n.trim(_)}},parse:function(t){var e=n.trim(t);return e=e.replace(/\.\d+/,""),e=e.replace(/T/," ").replace(/Z/," UTC"),e=e.replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),e=e.replace(/\s/,"T"),e=e.replace(/\+00/,""),e+="Z",new Date(e)},datetime:function(t){var e=d.isTime(t)?n(t).attr("datetime"):n(t).attr("title");return e.indexOf(" ")>-1?d.parse(e):new Date(e)},isTime:function(t){return n(t).get(0).tagName.toLowerCase()==="time"}}),n.fn.timeago=function(){var t=this;t.each(x);var e=d.settings;return e.refreshMillis>0&&setInterval(function(){t.each(x)},e.refreshMillis),t};function x(){var t=n(this).hasClass("longform"),e=n(this).hasClass("days_or_year"),g=n(this).hasClass("dateonly"),f=n(this).hasClass("datetime"),l=F(this);return isNaN(l.datetime)||n(this).text(v(l.datetime,t,e,g,f)),this}function F(t){if(t=n(t),!t.data("timeago")){t.data("timeago",{datetime:d.datetime(t)});var e=n.trim(t.text());if(e.length>0&&!(d.isTime(t)&&t.attr("title"))){var g=d.datetime(t).toString();t.attr("title","").attr("data-tiptip",g).addClass("has_tip").tipTip()}}return t.data("timeago")}function v(t,e,g,f,l){return d.inWords(t,N(t),e,g,f,l)}function N(t){return new Date().getTime()-t.getTime()}})(jQuery),rymQ(function(){$(".timeago").timeago()});
 
(function(o){o.fn.tipTip=function(y){var P={activation:"hover",keepAlive:!1,maxWidth:"1200px",edgeOffset:3,defaultPosition:"bottom",delay:200,fadeIn:200,fadeOut:200,attribute:"data-tiptip",content:!1,enter:function(){},exit:function(){}},t=o.extend(P,y);if(o("#tiptip_holder").length<=0){var i=o('<div id="tiptip_holder" style="pointer-events:none;max-width:'+t.maxWidth+';"></div>'),g=o('<div id="tiptip_content"></div>'),_=o('<div id="tiptip_arrow"></div>');o("body").append(i.html(g).prepend(_.html('<div id="tiptip_arrow_inner"></div>')))}else var i=o("#tiptip_holder"),g=o("#tiptip_content"),_=o("#tiptip_arrow");return this.each(function(){var r=o(this);if(t.content)var b=t.content;else var b=r.attr(t.attribute);if(b!=""){let h=function(){t.enter.call(this),g.html(b),i.hide().removeAttr("class").css("margin","0"),_.removeAttr("style");var n=parseInt(r.offset().top),l=parseInt(r.offset().left),x=parseInt(r.outerWidth()),u=parseInt(r.outerHeight()),d=i.outerWidth(),f=i.outerHeight(),m=Math.round((x-d)/2),I=Math.round((u-f)/2),v=Math.round(l+m),a=Math.round(n+u+t.edgeOffset),e="",c="",w=Math.round(d-12)/2;t.defaultPosition=="bottom"?e="_bottom":t.defaultPosition=="top"?e="_top":t.defaultPosition=="left"?e="_left":t.defaultPosition=="right"&&(e="_right");var A=m+l<parseInt(o(window).scrollLeft()),k=d+l>parseInt(o(window).width());A&&m<0||e=="_right"&&!k||e=="_left"&&l<d+t.edgeOffset+5?(e="_right",c=Math.round(f-13)/2,w=-12,v=Math.round(l+x+t.edgeOffset),a=Math.round(n+I)):(k&&m<0||e=="_left"&&!A)&&(e="_left",c=Math.round(f-13)/2,w=Math.round(d),v=Math.round(l-(d+t.edgeOffset+5)),a=Math.round(n+I));var M=n+u+t.edgeOffset+f+8>parseInt(o(window).height()+o(window).scrollTop()),O=n+u-(t.edgeOffset+f+8)<0;M||e=="_bottom"&&M||e=="_top"&&!O?(e=="_top"||e=="_bottom"?e="_top":e=e+"_top",c=f,a=Math.round(n-(f+5+t.edgeOffset))):(O|(e=="_top"&&O)||e=="_bottom"&&!M)&&(e=="_top"||e=="_bottom"?e="_bottom":e=e+"_bottom",c=-12,a=Math.round(n+u+t.edgeOffset)),e=="_right_top"||e=="_left_top"?a=a+5:(e=="_right_bottom"||e=="_left_bottom")&&(a=a-5),(e=="_left_top"||e=="_left_bottom")&&(v=v+5),_.css({"margin-left":w+"px","margin-top":c+"px"}),i.css({"margin-left":v+"px","margin-top":a+"px"}).attr("class","tip"+e),p&&clearTimeout(p),p=setTimeout(function(){i.stop(!0,!0).fadeIn(t.fadeIn)},t.delay)},s=function(){t.exit.call(this),p&&clearTimeout(p),i.fadeOut(t.fadeOut)};var T=h,W=s;t.content||r.removeAttr(t.attribute);var p=!1;t.activation=="hover"?(r.hover(function(){h()},function(){t.keepAlive||s()}),t.keepAlive&&i.hover(function(){},function(){s()})):t.activation=="focus"?r.focus(function(){h()}).blur(function(){s()}):t.activation=="click"&&(r.click(function(){return h(),!1}).hover(function(){},function(){t.keepAlive||s()}),t.keepAlive&&i.hover(function(){},function(){s()}))}})}})(jQuery);
 
var d=(e,a,s)=>new Promise((o,t)=>{var r=n=>{try{i(s.next(n))}catch(l){t(l)}},_=n=>{try{i(s.throw(n))}catch(l){t(l)}},i=n=>n.done?o(n.value):Promise.resolve(n.value).then(r,_);i((s=s.apply(e,a)).next())});function openShortcut(e){debugger;currentElement=e;var a=$(e).offset(),s=$("#shortcut").outerWidth(),o=$(window).outerWidth(),t=a.left+$(e).outerWidth();t+s>o&&(t=o-s),$("#shortcut").css("top",a.top+"px").css("left",t+"px").show(),shortcut_first_sc&&shortcut_first_sc!=""&&viewshortcut(shortcut_first_sc,shortcut_first_func)}function did(e){return document.getElementById(e)}function RYMSession(){this.userid=0,this.username="",this.token="",this.init=function(e,a,s,o){this.userid=e,this.username=a,this.token=s,this.rules_agreed=o},this.logout=function(){this.userid=0,this.username="",this.token=""},this.isLoggedIn=function(){return this.userid!=0},this.agreeRules=function(e){$.ajax({url:"/api/1/rules/"+e,method:"POST",dataType:"json",data:{category:e,action:"agree"},success:function(a,s,o){rym.closeModal(),rym.session.rules_agreed=a.rules_agreed,rym.session.rulesCallback()}})},this.confirmRules=function(e,a){this.rulesCallback=a,this.rules_agreed[e]&&a()}}var RYMresource={};function RYMRequest(){this.sendRequest=function(e,a,s,o,t,r){return t==null&&(t=!1),r==null&&(r="/httprequest/"+a.action),a.rym_ajax_req=1,a.request_token=rym.session.token,jQuery.ajax({url:r,type:e,data:a,success:s,dataType:o,cache:t})},this.post=function(e,a,s,o,t,r){return a.action=e,this.sendRequest("POST",a,s,o,t,r)},this.api=function(e,a,s){}}function RYM(){this.session=new RYMSession,this.request=new RYMRequest,this.doModalLoading=function(){$("#modal_content").show().loadingAnim(),$("#modal_parent_frame").show(),$("#modal_overlay").show(),$("html").addClass("modal_active")},this.closeModal=function(){$("#modal_parent_frame").hide(),$("#modal_content").html(""),$("#modal_overlay").fadeOut(100),$("html").removeClass("modal_active"),$("#body").off("keydown")},this.doModal=function(e,a,s){return d(this,null,function*(){s=s||{},s=Object.assign({mode:"message",frame_class:"standard"},s),$("#modal_parent_frame_inner")[0].className="modal_parent_frame_inner modal_parent_frame_inner_"+s.frame_class,$("#modal_parent_frame").show(),$("#modal_overlay").show(),$("html").addClass("modal_active"),renderTemplate("ui.modal",{title:a,body:e,frame_class:s.frame_class}).then(o=>{$("#modal_content").html(o).show().addClass(),$("#body").on("keydown",function(t){if(t&&t.keyCode)switch(t.keyCode){case g_keyCodes.esc:return rym.closeModal(),!1;break}})})})},this.doModal2=function(e,a,s){return d(this,null,function*(){s=s||{},s=Object.assign({mode:"message",frame_class:"standard"},s),$("#modal_parent_frame_inner_level_2")[0].className="modal_parent_frame_inner modal_parent_frame_inner_"+s.frame_class,$("#modal_parent_frame_level_2").show(),$("#modal_overlay_level_2").show(),$("html").addClass("modal_active"),renderTemplate("ui.modal",{title:a,body:e,frame_class:s.frame_class}).then(o=>{$("#modal_content_level_2").html(o).show().addClass(),$("#body").on("keydown",function(t){if(t&&t.keyCode)switch(t.keyCode){case g_keyCodes.esc:return rym.closeModal2(),!1;break}})})})},this.closeModal2=function(){$("#modal_parent_frame_level_2").hide(),$("#modal_content_level_2").html(""),$("#modal_overlay_level_2").hide(),$("#modal_parent_frame").is(":visible")||$("html").removeClass("modal_active"),$("#body").on("keydown",function(e){if(e&&e.keyCode)switch(e.keyCode){case g_keyCodes.esc:return rym.closeModal(),!1;break}})},this.clearGlobalError=function(){$("#header_error").hide()},this.showGlobalError=function(e){$("#header_error_text").html(e),$("#header_error").fadeIn(100).fadeOut(10).fadeIn(100),$("#submitbtn")&&$("#submitbtn").prop("disabled",!1)},this.showGlobalMessage=function(e){$("#header_message_text").html(e),$("#header_message").fadeIn(100),$("#submitbtn")&&$("#submitbtn").prop("disabled",!1)},this.setupPage=function(){$(".timeago").timeago(),$(".has_tip").tipTip(),$(".ui_textarea").textareaUI(),$(".page_section_dynamic_fade").dynamicFadeSectionUI()}}rym=new RYM;
 
var RYMdynamicSection={initFade:function(i){var n=i.data("dynamic-fade-initialized");if(!n){i.data("dynamic-fade-initialized",!0);var t=i[0].id,a=i.outerHeight(),e=i[0].scrollHeight;e-50>a?(i.find(".page_section_dynamic_fade_cover").show(),i.find(".page_section_dynamic_fade_expand_button").show().unbind().on("click",function(){i.toggleClass("expanded")})):i.removeClass("page_section_dynamic_fade")}},initList:function(i){}};$.fn.extend({dynamicFadeSectionUI:function(){$(this).each(function(i){RYMdynamicSection.initFade($(this))})}}),rymQ(function(){$(".page_section_dynamic_fade").dynamicFadeSectionUI()});
 
var RYMheader={onClickBars:function(){if($("#header_extended_section").is(":visible")){RYMheader.dismissDesktopMenu();return}$("#mobile_header_menu").addClass("fixed"),$("#header_extended_section").show(),$("#content_cover").css({width:"100%",height:$(document).height(),top:0,left:0}).show().on("click",function(){RYMheader.dismissDesktopMenu()})},dismissDesktopMenu:function(){$("#content_cover").off("click").hide(),$("#header_extended_section").fadeOut(50),$("#mobile_header_menu").removeClass("fixed")},toggleMobileMenu:function(){$("#content_cover").is(":visible")?RYMheader.hideMobileMenu():RYMheader.showMobileMenu()},showMobileMenu:function(){$("#header_expanded").show(),$("#mobile_header_menu").addClass("fixed");var e=$(document).height()+"px";$("#content_cover").css({width:"100%",height:e,top:"6em",left:0}).show().on("click",function(){RYMheader.hideMobileMenu()})},hideMobileMenu:function(){$("#header_expanded").hide(),$("#mobile_header_menu").removeClass("fixed"),$("#content_cover").hide().off("click")}};
 
var RYMmobile={mobileMenu:{enterSelectionMode:function(){$(".mobile_menu")[0].className="mobile_menu selection_mode"},exitSelectionMode:function(){$(".mobile_menu")[0].className="mobile_menu"}},mobileExpand:{toggleFull:function(e){$("#expand_full_"+e).toggleClass("expanded")},toggleSection:function(e){$("#expand_section_"+e).toggleClass("expanded")},toggleFade:function(e){$("#expand_fade_"+e).toggleClass("expanded")}}},RYMdynamicSection={initFade:function(e){var i=e.data("dynamic-fade-initialized");if(!i){e.data("dynamic-fade-initialized",!0);var t=e[0].id,n=e.outerHeight(),a=e[0].scrollHeight;a-50>n?(e.find(".page_section_dynamic_fade_cover").show(),e.find(".page_section_dynamic_fade_expand_button").show().unbind().on("click",function(){e.toggleClass("expanded")})):e.removeClass("page_section_dynamic_fade")}},initList:function(e){}};$.fn.extend({dynamicFadeSectionUI:function(){$(this).each(function(e){RYMdynamicSection.initFade($(this))})}});
 
var g=(a,e,n)=>new Promise((_,o)=>{var r=i=>{try{p(n.next(i))}catch(t){o(t)}},s=i=>{try{p(n.throw(i))}catch(t){o(t)}},p=i=>i.done?_(i.value):Promise.resolve(i.value).then(r,s);p((n=n.apply(a,e)).next())});var RYMpagination={openPageChooser:function(a){return g(this,null,function*(){$("#overlay_invisible").show().on("click",function(){RYMpagination.closePageChooser(a)}),$("#ui_pagination_page_chooser_"+a).show();for(var e='<div class="ui_pagination_page_chooser_row">',n=parseInt($("#ui_pagination_"+a).data("num-pages")),_=$("#ui_pagination_"+a).data("options"),o=1;o<=n;o++){o%10==0&&(e+='</div><div class="ui_pagination_page_chooser_row">');var r=_.url_template.replace("{{page}}",o);o==1&&(r=_.url_first_page);var s={url:r,num:o};e+=yield renderTemplate("ui.pagination.number",s)}e+="</div>",$("#ui_pagination_page_chooser_"+a).html(e)})},closePageChooser:function(a){$("#ui_pagination_page_chooser_"+a).hide(),$("#overlay_invisible").hide().off("click")}};
 
var h=(e,a,s)=>new Promise((l,r)=>{var c=n=>{try{o(s.next(n))}catch(i){r(i)}},t=n=>{try{o(s.throw(n))}catch(i){r(i)}},o=n=>n.done?l(n.value):Promise.resolve(n.value).then(c,t);o((s=s.apply(e,a)).next())});var RYMsearch={lastAjaxRequest:null,lastSearchValue:null,lastSearchTimer:null,searchDelay:1500,resultCache:{},currentResultSet:{},currentSelectedItem:{},blurTimer:{},initState:{},selectedId:null,searchEndpoint:"https://api.sonemic.com/1/search",types:{Music:[{type:"music",name:"music",label:"Everything",searchlabel:"music"},{type:"a",name:"artist",label:"Artists",searchlabel:"artists"},{type:"l",name:"release",label:"Releases",searchlabel:"releases"},{type:"y",name:"release",label:"V/A Releases",searchlabel:"va_releases"},{type:"b",name:"company_music",label:"Labels",searchlabel:"companies"},{type:"j",name:"catalog_no",label:"Catalog No.",searchlabel:"catalog_no"},{type:"g",name:"genre",label:"Genres",searchlabel:"music genres"},{type:"r",name:"work",label:"Works",searchlabel:"works"},{type:"u",name:"user",label:"Users",searchlabel:"user"},{type:"s",name:"list",label:"Lists",searchlabel:"list"}],Film:[{type:"films",name:"films",label:"Everything",searchlabel:"films"},{type:"F",name:"film",label:"Film titles",searchlabel:"film titles"},{type:"A",name:"film_person",label:"People",searchlabel:"cast/crew"},{type:"fg",name:"genre",label:"Genres",searchlabel:"film genres"}],Games:[{name:"games",label:"Everything",searchlabel:"games"},{name:"game",label:"Game titles",searchlabel:"game titles"},{name:"game_person",label:"People",searchlabel:"game persons"},{name:"company_game",label:"Companies",searchlabel:"game companies"},{name:"game_platform",label:"Platforms",searchlabel:"game platforms"},{name:"genre",label:"Genres",searchlabel:"game genres"},{name:"franchise",label:"Franchises",searchlabel:"franchises"},{name:"character",label:"Characters",searchlabel:"characters"},{name:"descriptor",label:"Descriptors",searchlabel:"game descriptors"},{name:"user",label:"Users",searchlabel:"user"},{name:"list",label:"Lists",searchlabel:"list"}],Community:[{name:"user",label:"Users",searchlabel:"users"},{name:"list",label:"Lists",searchlabel:"lists"}],location:[{name:"location",label:"Location",searchlabel:"location"}]},setHelpHeader:function(e,a){return h(this,null,function*(){let s=yield renderTemplate("ui.search.help."+a,{});$("#ui_search_results_"+e).html(s)})},initContextIndicator:function(e,a){var s="";switch(a){case"insertShortcut":var l=$("#ui_search_"+e).data("callback-id"),r=document.getElementById(l);if(r){var c=document.getElementById(l).selectionStart,t=$("#"+l).val();s=t.substring(0,c)+" [______]"}break;case"catalog":s="Catalog item...";break;case"addToList":s="Add to list...";break;default:s=""}$("#ui_search_context_indicator_inner_"+e).text(s)},init:function(e){var a=$("html, body").hasClass("scope_film")?"film":"music",s=$("#ui_search_"+e).data("callback");RYMsearch.selectScope(e,a),RYMsearch.setHelpHeader(e,"search"),RYMsearch.initContextIndicator(e,s),RYMsearch.initState[e]=!0;var l=$("#ui_search_input_"+e).val();l.length>0&&$("#ui_search_frame_"+e).addClass("has_content")},setDialogActive:function(e,a){RYMsearch.stopBodyScrolling(!a),a?(RYMsearch.lastBodyYOffset=document.body.scrollTop,$("#ui_search_frame_"+e).addClass("active")[0].scrollTop=0,$("html").addClass("modal_search_active"),$("#overlay_invisible").show().on("click",function(){RYMsearch.close(e)}),document.body.scrollTop=0):(document.body.scrollTop=RYMsearch.lastBodyYOffset,$("#ui_search_frame_"+e).removeClass("active"),$("html").removeClass("modal_search_active"),$("#overlay_invisible").hide().off("click"))},_freezeVp:function(e){e.preventDefault()},stopBodyScrolling:function(e){e===!0?document.body.addEventListener("touchmove",RYMsearch._freezeVp,!1):document.body.removeEventListener("touchmove",RYMsearch._freezeVp,!1)},_onSearchResults:function(e,a){return h(this,null,function*(){RYMsearch.lastSearchTimer=null;var s="",l=$("#ui_search_object_select_"+e).val();if(a.results.length===0)RYMsearch.setHelpHeader(e,"noresults");else{for(var r in a.results){s+='<div class="ui_search_object_category">',s+='<div class="ui_search_object_category_label">'+a.results[r].label_display,a.results[r].object!==l&&(s+=`<div onClick="RYMsearch.setObject('`+e+"', '"+a.results[r].object+`');" class="ui_search_object_category_only_btn">Only</div>`),s+="</div>";for(var c in a.results[r].items){var t=a.results[r].items[c];t.id=e,s+=yield renderTemplate("ui.search.result",t)}s+="</div>"}$("#ui_search_results_"+e).html(s),$(".has_tip").tipTip()}})},redirSearch:function(e){var a=$("#ui_search_input_"+e).val(),s=$("#ui_search_scope_"+e).val(),l=$("#ui_search_object_select_"+e).val();l==="music"&&(l=""),window.location="/search?searchterm="+encodeURIComponent(a)+"&searchtype="+l},doSearch:function(e){var a=$("#ui_search_input_"+e).val(),s=$("#ui_search_scope_"+e).val(),l=$("#ui_search_object_select_"+e).val(),r=$("#ui_search_"+e).data("config-string"),c=$("#ui_search_"+e).data("test-server");if(a.length==0){RYMsearch.setHelpHeader(e,"search");return}if(RYMsearch.lastAjaxRequest){try{RYMsearch.lastAjaxRequest.abort()}catch(i){}RYMsearch.lastAjaxRequest=null}var t;typeof c!="undefined"&&c.length>0?t={q:a,t:l,scope:s,test_server:c}:t={q:a,t:l,scope:s},t[r]=!0;var o=JSON.stringify(t);if(RYMsearch.resultCache[o]){var n=RYMsearch.resultCache[o];RYMsearch._onSearchResults(e,RYMsearch.resultCache[o]),$("#ui_search_icon_"+e)[0].className="fa fa-search ui_search_icon",console.log("Using cached search result for "+a);return}$("#ui_search_debug_"+e).html(""),RYMsearch.lastSearchTimer?(clearTimeout(RYMsearch.lastSearchTimer),RYMsearch.lastSearchTimer=null):$("#ui_search_results_"+e).html('<div class="page_loading">Loading...</div>')},close:function(e){RYMsearch.setDialogActive(e,!1),$("#overlay_invisible").hide().off("click")},clearSearch:function(e){$("#ui_search_input_"+e).val(""),RYMsearch.setHelpHeader(e,"search"),$("#ui_search_frame_"+e).removeClass("has_content")},onEscape:function(e){var a=$("#ui_search_input_"+e).val();a.length>0?RYMsearch.clearSearch(e):RYMsearch.close(e)},onFocus:function(e,a){RYMsearch.setDialogActive(a,!0);var s=$("#ui_search_"+a).data("callback");RYMsearch.initContextIndicator(a,s),RYMsearch.initState[a]||RYMsearch.init(a),rym.nextSearchType&&($("#ui_search_object_select_"+a).val(rym.nextSearchType),rym.nextSearchType=null)},onClickClose:function(e,a){RYMsearch.close(a)},onClickClearSearch:function(e,a){RYMsearch.clearSearch(a),RYMsearch.setDialogActive(a,!1)},onBlur:function(e,a){var s=$("#ui_search_input_"+a).val();s.length==0},onKeyDown:function(e,a){if(e&&e.keyCode)switch(e.keyCode){case g_keyCodes.esc:return RYMsearch.onEscape(a),!1;break;case g_keyCodes.up:return!1;case g_keyCodes.down:return!1;case g_keyCodes.ret:return RYMsearch.redirSearch(a),!1}},onInput:function(e,a){var s=$("#ui_search_input_"+a).val();s.length>0?($("#ui_search_frame_"+a).addClass("has_content"),RYMsearch.setDialogActive(a,!0)):$("#ui_search_frame_"+a).removeClass("has_content"),RYMsearch.doSearch(a)},onClickShortcut:function(e,a){e.stopPropagation(),$("#ui_search_result_shortcut_frame_"+a).addClass("clicked");var s=$("#ui_search_result_shortcut_"+a);return s.focus(),s.select(),!1},setObject:function(e,a){$("#ui_search_object_select_"+e).val(a),RYMsearch.doSearch(e)},onChangeObject:function(e,a){if(window.rym.preserveSearchType){var s=$("html, body").hasClass("scope_film")?"film":"music";window.localStorage["last_searchtype_"+s]=$("#ui_search_object_select_"+a).val()}RYMsearch.doSearch(a)},selectScope:function(e,a){a==="music"||a==="film"?$("#ui_search_results_frame_main_search").hide():$("#ui_search_results_frame_main_search").show(),$("#ui_search_scope_selector_"+e+" .ui_search_scope_selector_item").removeClass("selected"),$("#ui_search_scope_selector_"+a+"_"+e).addClass("selected"),$("#ui_search_scope_"+e).val(a),RYMsearch.populateSelectGroup(e,a),RYMsearch.doSearch(e)},onClickSearchScope:function(e,a,s){RYMsearch.selectScope(a,s)},insertShortcut:function(e,a){var s=$("#ui_search_"+e).data("callback-id"),l=document.getElementById(s).selectionStart,r=$("#"+s).val(),c=r.substring(0,l);c[c.length-1]!==" "&&(c+=" ");var t=r.substring(l);t.length>0&&t[0]!==" "&&(t=" "+t),$("#"+s).val(c+"["+a+"]"+t).focus(),RYMsearch.clearSearch(e),RYMsearch.close(e)},onClickResult:function(e,a,s,l,r,c,t,o,n){var i=$("#ui_search_"+r).data("callback");if(typeof e!="undefined"?wevt=e:window.event&&(wevt=window.event),n||wevt&&(wevt.shiftKey||wevt.metaKey||e&&e.which==2))return n?(window.open("https://"+s+l,"_blank"),!1):!0;if(wevt&&(wevt.shiftKey||wevt.metaKey||e&&e.which==1))switch(e.stopPropagation(),i){case"insertShortcut":RYMsearch.insertShortcut(r,o);break;case"catalog":RYMsearch.openCatalog(r,c,t);break;case"addToList":RYMsearch.openAddToList(r,c,t);break;default:window.location="https://"+s+l}return!1},populateSelectGroup:function(e,a){var s=!1,l=$("#ui_search_object_select_"+e),r=new Array,c=new Array,t=null,o=0;for(var n in RYMsearch.types){var i=RYMsearch.types[n],u=null;for(var m in i){var f=i[m].type,v=i[m].label,_=n.toLowerCase();(s||a==_)&&(r.indexOf(_)==-1&&(r.push(_),u=$('<optgroup label="'+n+'"></optgroup>'),t||(t=f)),u.append($('<option value="'+f+'">'+v+"</option>")),o++)}u&&c.push(u)}for(var p in c)l.html(c[p]);l.val(t)}};
 
var s=(i,a,e)=>new Promise((t,o)=>{var _=n=>{try{l(e.next(n))}catch(d){o(d)}},c=n=>{try{l(e.throw(n))}catch(d){o(d)}},l=n=>n.done?t(n.value):Promise.resolve(n.value).then(_,c);l((e=e.apply(i,a)).next())});var RYMtextarea={init:function(i){return s(this,null,function*(){var a=$(i).data("id"),e=$("#"+a),t=e.data("autoresize")||!1,o=$("#ui_textarea_tool_bold_"+a),_=$("#ui_textarea_tool_italic_"+a),c=$("#ui_textarea_tool_image_"+a),l=$("#ui_textarea_tool_embed_"+a),n=$("#ui_textarea_embed_insert_"+a),d=$("#ui_textarea_tool_link_"+a),v=$("#ui_textarea_link_insert_"+a),m=$("#ui_textarea_tool_tips_"+a),h="ontouchstart"in window;o.unbind().on("click",function(r){RYMtextarea.onClickBold($(e),r)}),_.unbind().on("click",function(r){RYMtextarea.onClickItalic($(e),r)}),c.unbind().on("click",function(r){RYMtextarea.onClickImage($(e),r)}),l.unbind().on("click",function(r){RYMtextarea.onClickEmbed($(e),r)}),n.unbind().on("click",function(r){RYMtextarea.onClickEmbedInsert($(e),r)}),d.unbind().on("click",function(r){RYMtextarea.onClickLink($(e),r)}),v.unbind().on("click",function(r){RYMtextarea.onClickLinkInsert($(e),r)}),m.unbind().on("click",function(r){RYMtextarea.onClickTips($(e),r)}),t&&e.on("input",function(r){RYMtextarea._autoResize(e,r)});var u;typeof window.rym_search_test_server!="undefined"?u={id:"ui_textarea_search_"+a,default_scope:window.rym_scope,test_server:window.rym_search_test_server,config_string:window.rym_search_config_string,callback:"insertShortcut",callback_id:a}:u={id:"ui_textarea_search_"+a,default_scope:window.rym_scope,callback:"insertShortcut",callback_id:a};let f=yield renderTemplate("ui.search",u);$("#ui_textarea_search_frame_"+a).html(f)})},_autoResize:function(i,a){return;var e,t,o,_,c,l,n},insertFormatTag:function(i,a,e){var t=i[0],o=t.scrollTop;if(document.selection){var _=document.selection.createRange().text;t.focus();var c=document.selection.createRange();c.text=a+_+e}else if(t.selectionStart|t.selectionStart==0){t.selectionEnd>t.value.length&&(t.selectionEnd=t.value.length);var l=t.selectionStart,n=t.selectionEnd+a.length;t.value=t.value.slice(0,l)+a+t.value.slice(l),t.value=t.value.slice(0,n)+e+t.value.slice(n),t.selectionStart=l+a.length,t.selectionEnd=n,t.focus()}t.scrollTop=o},onClickBold:function(i,a){var e=$(i).data("id"),t=$("#"+e);RYMtextarea.insertFormatTag(t,"[b]","[/b]")},onClickItalic:function(i,a){var e=$(i).data("id"),t=$("#"+e);RYMtextarea.insertFormatTag(t,"[i]","[/i]")},onClickImage:function(i,a){var e=$(i).data("id");$("#ui_textarea_link_"+e).hide(),$("#ui_textarea_embed_"+e).hide(),$("#ui_textarea_image_"+e).slideToggle(100)},onClickEmbed:function(i,a){var e=$(i).data("id");$("#ui_textarea_link_"+e).hide(),$("#ui_textarea_image_"+e).hide(),$("#ui_textarea_embed_"+e).slideToggle(100),$("#ui_textarea_embed_error_"+e).hide()},onClickEmbedInsert:function(i,a){var e=$(i).data("id"),t=$("#ui_textarea_embed_input_"+e).val();rym.request.post("UiValidateEmbedCode",{id:e,text:t},null,"script")},_embedCodeSuccessCallback:function(i,a){RYMtextarea.insertFormatTag($("#"+i),a,""),$("#ui_textarea_embed_input_"+i).val(""),$("#ui_textarea_embed_"+i).hide()},_embedCodeFailureCallback:function(i,a){$("#ui_textarea_embed_error_"+i).text(a).hide().fadeIn(200)},_imageUploadCallback:function(i,a,e){var t="[image:"+a+"]";RYMtextarea.insertFormatTag($("#"+i),t,"")},onClickLink:function(i,a){var e=$(i).data("id");$("#ui_textarea_image_"+e).hide(),$("#ui_textarea_embed_"+e).hide(),$("#ui_textarea_link_"+e).slideToggle(100),$("#ui_textarea_link_error_"+e).hide()},onClickLinkInsert:function(i,a){var e=$(i).data("id"),t=$("#ui_textarea_link_url_"+e).val(),o=$("#ui_textarea_link_name_"+e).val();$("#ui_textarea_link_error_"+e).hide(),t.indexOf("https://")!=0&&t.indexOf("http://")!=0?$("#ui_textarea_link_error_"+e).text("The link you entered is not valid.  Please use a link that starts with http:// or https://").fadeIn(200):o.length>0?RYMtextarea.insertFormatTag($("#"+e),"["+t+","+o+"]",""):RYMtextarea.insertFormatTag($("#"+e),t,"")},onClickTips:function(i,a){var e=$(i).data("id");$("#ui_textarea_help_"+e).slideToggle(100)}};$.fn.extend({textareaUI:function(){$(this).each(function(i){RYMtextarea.init($(this))})}}),rymQ(function(){$(".ui_textarea").textareaUI()});
 
 
